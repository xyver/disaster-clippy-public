# Copy this to .env and fill in your values
# See security_update.md for architecture overview

# =============================================================================
# DEPLOYMENT MODE
# =============================================================================

# Public mode (Railway deployment): blocks admin panel, exposes only chat
# Set to true on Railway, leave empty or false for local admin
PUBLIC_MODE=false

# Admin mode: local or global
# - local: Can manage local sources, download from cloud, no cloud write access
# - global: Full access including cloud uploads, Pinecone sync (requires R2 write keys)
ADMIN_MODE=local

# =============================================================================
# EMBEDDING & LLM PROVIDERS
# =============================================================================

# Embedding mode: openai or local
# - openai: Uses OpenAI API (costs money but high quality)
# - local: Uses sentence-transformers (free, runs on your machine)
#   Requires: pip install sentence-transformers
EMBEDDING_MODE=local

# OpenAI API key (needed for embeddings if EMBEDDING_MODE=openai, or for chat)
OPENAI_API_KEY=your_openai_api_key_here

# Anthropic (for chat LLM - optional, can use OpenAI instead)
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# LLM provider: openai, anthropic
LLM_PROVIDER=openai

# =============================================================================
# VECTOR DATABASE
# =============================================================================

# Vector DB mode: local, pinecone
# - local: ChromaDB stored in BACKUP_PATH/chroma (for local admin)
# - pinecone: Cloud vector database (for Railway or global admin)
VECTOR_DB_MODE=local

# Pinecone (only needed if VECTOR_DB_MODE=pinecone)
PINECONE_API_KEY=your_pinecone_api_key_here
PINECONE_ENVIRONMENT=us-east-1
PINECONE_INDEX_NAME=disaster-clippy

# =============================================================================
# LOCAL STORAGE
# =============================================================================

# Offline backups storage path (for ZIM files, HTML backups, ChromaDB)
# Set this to an external drive or large storage location
# REQUIRED for local admin - all source data is stored here
# NOT needed for Railway (uses Pinecone + R2 only)
BACKUP_PATH=D:\disaster-backups

# =============================================================================
# CLOUD STORAGE (Cloudflare R2) - TWO BUCKET SYSTEM
# =============================================================================
# Backups bucket: Published source packs (read-only for most users)
# Submissions bucket: User-submitted content awaiting review (write access)

# --- BACKUPS BUCKET (read-only API key) ---
# Contains published, validated source packs
# Railway: needs read access to serve downloads
# Local admin: needs read access to download packs (or use proxy)
# Global admin: needs read+write to publish new packs
R2_ACCESS_KEY_ID=your_backups_readonly_key_here
R2_SECRET_ACCESS_KEY=your_backups_readonly_secret_here
R2_ENDPOINT_URL=https://your-account-id.r2.cloudflarestorage.com
R2_BUCKET_NAME=disaster-clippy-backups

# --- SUBMISSIONS BUCKET (read/write API key) ---
# Contains user-submitted content pending review
# Railway: needs write access to accept submissions
# Global admin: needs read+write to review and approve/reject
R2_SUBMISSIONS_ACCESS_KEY_ID=your_submissions_rw_key_here
R2_SUBMISSIONS_SECRET_ACCESS_KEY=your_submissions_rw_secret_here
R2_SUBMISSIONS_BUCKET_NAME=disaster-clippy-submissions

# =============================================================================
# RAILWAY PROXY (for local admins without API keys)
# =============================================================================

# URL of your Railway deployment
# Local admins can use this to access cloud features without their own API keys
# Set in local_settings.json via admin UI, or here as override
RAILWAY_PROXY_URL=https://your-app.up.railway.app

# =============================================================================
# ADMIN & SECURITY
# =============================================================================

# Admin API key (for protected endpoints like /api/cloud/*)
ADMIN_API_KEY=your_admin_key_here

# =============================================================================
# OPTIONAL: SCRAPING
# =============================================================================

# Substack session cookie (for scraping private newsletters)
# Get this from browser dev tools after logging into Substack
SUBSTACK_SESSION_COOKIE=your_session_cookie_here


# =============================================================================
# DEPLOYMENT CONFIGURATIONS
# =============================================================================
#
# RAILWAY (Public Chat Server):
#   PUBLIC_MODE=true
#   VECTOR_DB_MODE=pinecone
#   PINECONE_API_KEY=xxx
#   OPENAI_API_KEY=xxx
#   R2_ACCESS_KEY_ID=xxx (backups read-only)
#   R2_SUBMISSIONS_ACCESS_KEY_ID=xxx (submissions read/write)
#   (No BACKUP_PATH needed)
#
# LOCAL ADMIN (with own keys):
#   PUBLIC_MODE=false
#   ADMIN_MODE=local
#   VECTOR_DB_MODE=local
#   BACKUP_PATH=/path/to/backups
#   OPENAI_API_KEY=xxx (or EMBEDDING_MODE=local)
#   (Optional: R2 keys for direct cloud access)
#
# LOCAL ADMIN (using Railway proxy):
#   PUBLIC_MODE=false
#   ADMIN_MODE=local
#   VECTOR_DB_MODE=local
#   BACKUP_PATH=/path/to/backups
#   EMBEDDING_MODE=local
#   RAILWAY_PROXY_URL=https://your-app.up.railway.app
#   (No API keys needed - uses Railway as proxy)
#
# GLOBAL ADMIN (full cloud access):
#   PUBLIC_MODE=false
#   ADMIN_MODE=global
#   VECTOR_DB_MODE=pinecone
#   BACKUP_PATH=/path/to/backups
#   PINECONE_API_KEY=xxx
#   OPENAI_API_KEY=xxx
#   R2_ACCESS_KEY_ID=xxx (backups read+write key)
#   R2_SUBMISSIONS_ACCESS_KEY_ID=xxx (submissions read+write)
